# 배포 시 RDS에 TypeORM 마이그레이션 실행 (EB 인스턴스가 VPC 내부이므로 RDS 접근 가능)
# Elastic Beanstalk 환경 변수(DB_HOST, DB_PORT 등)를 EB 콘솔에서 설정해야 함
# app_staging_dir = 배포 중인 앱 디렉터리 (dist, node_modules 포함)
container_commands:
  01_run_migration:
    command: "cd $(/opt/elasticbeanstalk/bin/get-config container -k app_staging_dir) && npx typeorm migration:run -d dist/database/data-source.js"
    leader_only: true
